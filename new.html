<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>2-DOF 평면 로봇팔 시뮬레이터 (이미지 적용 수정)</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #f7f7f7;
      }
      #p5-canvas {
        border: 2px solid #333;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        background-color: #ffffff;
        width: 100%;
        height: 100%;
      }
      .control-label {
        width: 120px;
        font-weight: 600;
      }
    </style>
  </head>

  <body class="p-6 h-screen flex flex-col lg:flex-row gap-6">
    <div
      id="control-panel"
      class="lg:w-1/3 p-6 bg-white rounded-xl shadow-lg flex flex-col gap-4 max-h-full overflow-y-auto"
    >
      <h1 class="text-2xl font-bold text-gray-800 border-b pb-2 mb-2">
        로봇팔 제어판 (2-DOF)
      </h1>

      <div class="text-sm text-gray-600 mb-2">
        제원: L1(J1-J2) 73mm, L2(J2-펜) 79mm 비율 적용.
      </div>

      <div class="flex flex-col gap-2 p-3 bg-indigo-50 rounded-lg">
        <h2 class="font-semibold text-indigo-700">Joint 1 (어깨) - Motor 0</h2>

        <div class="flex items-center">
          <span class="control-label text-xs">목표 각도 (0~150°):</span>

          <input
            type="range"
            id="targetAngle1_slider"
            min="0"
            max="150"
            value="45"
            step="1"
            class="w-full h-2 bg-indigo-200 rounded-lg appearance-none cursor-pointer"
          />
        </div>

        <div class="flex items-center">
          <span class="control-label text-xs">현재:</span>
          <span
            id="currentAngle1_display"
            class="font-mono text-sm ml-2 w-10 text-right"
            >0</span
          >° <span class="ml-4 control-label text-xs">목표:</span>

          <input
            type="number"
            id="targetAngle1_input"
            min="0"
            max="150"
            value="0"
            step="1"
            class="w-16 p-1 border rounded text-sm text-right font-mono focus:ring-indigo-500 focus:border-indigo-500"
          />°
        </div>
      </div>

      <div class="flex flex-col gap-2 p-3 bg-red-50 rounded-lg">
        <h2 class="font-semibold text-red-700">Joint 2 (팔꿈치) - Motor 1</h2>

        <div class="flex items-center">
          <span class="control-label text-xs">목표 각도 (-10~100°):</span>

          <input
            type="range"
            id="targetAngle2_slider"
            min="-10"
            max="100"
            value="45"
            step="1"
            class="w-full h-2 bg-red-200 rounded-lg appearance-none cursor-pointer"
          />
        </div>

        <div class="flex items-center">
          <span class="control-label text-xs">현재:</span>
          <span
            id="currentAngle2_display"
            class="font-mono text-sm ml-2 w-10 text-right"
            >0</span
          >° <span class="ml-4 control-label text-xs">목표:</span>

          <input
            type="number"
            id="targetAngle2_input"
            min="-10"
            max="100"
            value="0"
            step="1"
            class="w-16 p-1 border rounded text-sm text-right font-mono focus:ring-red-500 focus:border-red-500"
          />°
        </div>
      </div>

      <div class="flex flex-col gap-2 p-3 bg-yellow-100 rounded-lg">
        <h2 class="font-semibold text-yellow-800">펜 궤적 제어</h2>

        <div class="flex items-center justify-between">
          <label
            for="pen_toggle"
            class="control-label text-xs cursor-pointer flex-grow"
          >
            <span id="pen_status" class="font-bold text-gray-700"
              >펜 꺼짐 (OFF)</span
            >
          </label>

          <input
            type="checkbox"
            id="pen_toggle"
            class="form-checkbox h-5 w-5 text-yellow-500 rounded focus:ring-yellow-500 transition duration-150 ease-in-out"
          />
        </div>

        <button
          id="clear_path_button"
          class="mt-2 w-full bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition duration-150 shadow-md hover:shadow-lg"
        >
          궤적 지우기
        </button>
      </div>

      <div class="flex flex-col gap-2 p-3 bg-gray-100 rounded-lg">
        <h2 class="font-semibold text-gray-700">시뮬레이션 속도</h2>

        <div class="flex items-center">
          <span class="control-label text-xs">이동 속도:</span>

          <input
            type="range"
            id="angleSpeed_slider"
            min="1"
            max="100"
            value="40"
            step="1"
            class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer"
          />

          <span
            id="angleSpeed_display"
            class="font-mono text-sm ml-2 w-10 text-right"
            >40</span
          >
        </div>
      </div>

      <div class="flex flex-col gap-2 p-3 bg-teal-50 rounded-lg">
        <h2 class="font-semibold text-teal-700">시뮬레이션 확대/축소</h2>

        <div class="flex items-center">
          <span class="control-label text-xs">배율 (0.5x ~ 2.0x):</span>

          <input
            type="range"
            id="zoom_slider"
            min="25"
            max="200"
            value="100"
            step="10"
            class="w-full h-2 bg-teal-200 rounded-lg appearance-none cursor-pointer"
          />

          <span id="zoom_display" class="font-mono text-sm ml-2 w-10 text-right"
            >1.0x</span
          >
        </div>

        <button
          id="zoom_reset_button"
          class="mt-2 w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition duration-150 shadow-md hover:shadow-lg"
        >
          확대/축소 재설정
        </button>
      </div>

      <div class="p-3 bg-yellow-50 rounded-lg mt-4">
        <h2 class="font-semibold text-yellow-800">펜 끝 (End-Effector) 좌표</h2>

        <div class="font-mono text-sm mt-1">
          <p>X: <span id="x_end_display">0.00</span></p>

          <p>Y: <span id="y_end_display">0.00</span></p>
        </div>
      </div>
    </div>

    <div class="lg:w-2/3 flex items-center justify-center min-h-[400px]">
      <div id="p5-canvas" class="w-full h-full min-h-[400px]"></div>
    </div>

    <script type="module" src="simulator.js"></script>
  </body>
</html>
